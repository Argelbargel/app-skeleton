plugins {
    id("base")
    id("com.github.node-gradle.node").version("2.2.4")
}

group("com.github.argelbargel")

ext {
    def os = org.gradle.nativeplatform.platform.internal.DefaultNativePlatform.currentOperatingSystem
    osName = "unknown"
    if (os.linux) {
        osName = "linux"
    } else if (os.windows) {
        osName = "windows"
    }

    nodeVersion = "14.15.4"
    cordovaVersion = "10.0.0"
    
    if (System.env.JAVA_HOME == null || !file(System.env.JAVA_HOME).exists()) {
        logger.warn("JAVA_HOME is not set or not present at '${System.env.JAVA_HOME}'!")
    }

    userHomeDir= System.properties['user.home']
    androidProjectSdkRootDir = "${gradle.gradleUserHomeDir}/android-sdk"
    androidSdkHomeDir = file(androidProjectSdkRootDir).exists() ? androidProjectSdkRootDir : System.env.ANDROID_HOME
    androidSdkRootDir = file(androidProjectSdkRootDir).exists() ? androidProjectSdkRootDir : System.env.ANDROID_SDK_HOME
    androidSdkCommandlineToolsVersion = "6858069_latest"
    androidSdkSystemImage = "system-images;android-29;google_apis;x86_64"
    androidSdkPackages = [ 
        "build-tools;29.0.2", 
        "platform-tools", 
        "platforms;android-29", 
        "sources;android-29",
        androidSdkSystemImage
    ]
    androidSdkAvdDevice = "pixel_3"

    nodePluginWorkDir = file("${gradle.gradleUserHomeDir}/nodejs")
    nodeJsInstallDir = "${nodePluginWorkDir}/node-v${nodeVersion}-${osName}"

    cordovaAppDir = "${projectDir}/cordova-app/"
}

apply from: "gradle/android-sdk.gradle"
apply from: "gradle/cordova.gradle" 

